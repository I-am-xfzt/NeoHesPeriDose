
var wuhanshi = "//img.isqqw.com/profile/upload/2024/11/22/da054351-0e09-4722-ba8f-5b9e2b4a741e.json"
var img2 = 'images://data:images/png;base64,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';
var mapname = wuhanshi;

var mapDate = [
    {
        name: '江岸区',
        value: [114.320896, 30.642672],
        datas: 2432,
        img: 'images:///asset/get/s/data-1619059442567-s5l7-f8Eu9.png',
    },
    {
        name: '汉阳区',
        value: [114.209517, 30.541833],
        datas: 9462,
        img: 'images:///asset/get/s/data-1619059442567-s5l7-f8Eu9.png',
    },
    {
        name: '蔡甸区',
        value: [113.96512, 30.451884],
        datas: 1354,
        img: 'images:///asset/get/s/data-1619059442567-s5l7-f8Eu9.png',
    },
    {
        name: '江夏区',
        value: [114.360325, 30.243389],
        datas: 1402,
        img: 'images:///asset/get/s/data-1619059442567-s5l7-f8Eu9.png',
    },

    {
        name: '新洲区',
        value: [114.752673, 30.798095],
        datas: 2468,
        img: 'images:///asset/get/s/data-1619059838735-QE9mBZmhh.png',
    },
    {
        name: '黄陂区',
        value: [114.355245, 30.978113],
        datas: 768,
        img: 'images:///asset/get/s/data-1619321685306-EvjlgDOXi.png',
    },
    {
        name: '东西湖区',
        value: [114.076902, 30.690527],
        datas: 768,
        img: 'images:///asset/get/s/data-1619321685306-EvjlgDOXi.png',
    },
];


let index = -1;
myChart.showLoading('default', {
    text: '统计中，请稍候...',
    maskColor: '#2957A2',
    textColor: '#fff',
});


setTimeout(function () {
    mapInit();
}, 1000);
var mapInit = () => {
    $.getJSON(mapname, function (geoJson) {
        echarts.registerMap('bd', geoJson);
        geoJson.features.map(el => {
            el.numData = mapDate.find(item => item.name == el.properties.name)
        })

        let data = geoJson.features.map((item, index) => {
            return {
                name: item.properties.name,
                datas: item.numData?.datas || 0
            };
        });
      
        myChart.hideLoading();
        option = {
            backgroundColor: "#030528",
            tooltip: {
                trigger: 'item',
                position: function (point, params, dom, rect, size) {
                    var x = 0; // x坐标位置
                    var y = 0; // y坐标位置
                    // 当前鼠标位置
                    var pointX = point[0];
                    var pointY = point[1];
                    // 提示框大小
                    var boxWidth = size.contentSize[0];
                    var boxHeight = size.contentSize[1];

                    // boxWidth > pointX 说明鼠标左边放不下提示框
                    if (boxWidth > pointX) {
                        x = pointX + 10;
                    } else { // 左边放的下
                        x = pointX - boxWidth - 10;
                    }

                    // boxHeight > pointY 说明鼠标上边放不下提示框
                    if (boxHeight > pointY) {
                        y = 5;
                    } else { // 上边放得下
                        y = pointY - boxHeight;
                    }
                    return [x, y];
                },
                show: true,
                enterable: true,
                textStyle: {
                    fontSize: 13,
                    color: '#fff',
                },
                backgroundColor: 'rgba(0,2,89,0.8)',

                formatter: function (params) {
                    var tipHtml = '';
                    tipHtml = `
                    <div class="ui-map-img">
                        <div class='ui-maptxt'>${params.name}</div>
                        <div class='ui-mapNum'>数量:${params.data.datas}</div>
                    </div>
                `
                    return tipHtml;
                },

            },
            title: {
                top: 20,
                text: '',
                subtext: '',
                x: 'center',
                textStyle: {
                    color: 'BLACK',
                    fontWeight: 100,
                    fontSize: 14,
                },
            },
            geo: [{
                map: "bd",
                aspectScale: 1,
                zoom: 0.56,
                silent: true,
                layoutCenter: ["50%", "50%"],
                layoutSize: "180%",
                show: true,
                roam: false,
                label: {
                    emphasis: {
                        show: false,
                    },
                },
                itemStyle: {
                    normal: {
                        borderColor: "#c0f3fb",
                        borderWidth: 1,
                        shadowColor: "#8cd3ef",
                        shadowOffsetY: 10,
                        shadowBlur: 120,
                        areaColor: "transparent",
                    },
                    emphasis: {
                        areaColor: '#2AB8FF',
                        borderWidth: 1,
                        color: 'green',
                        label: {
                            show: false,
                        },
                    },
                }
            },
            // 重影
            {
                type: "map",
                map: "bd",
                zlevel: -1,
                aspectScale: 1,
                zoom: 0.56,
                layoutCenter: ["50%", "51%"],
                layoutSize: "180%",
                roam: false,
                silent: true,
                itemStyle: {
                    normal: {
                        borderWidth: 1,
                        // borderColor:"rgba(17, 149, 216,0.6)",
                        borderColor: "rgba(58,149,253,0.8)",
                        shadowColor: "rgba(172, 122, 255,0.5)",
                        shadowOffsetY: 5,
                        shadowBlur: 15,
                        areaColor: "rgba(5,21,35,0.1)",
                    },
                },
            }, {
                type: "map",
                map: "bd",
                zlevel: -2,
                aspectScale: 1,
                zoom: 0.56,
                layoutCenter: ["50%", "52%"],
                layoutSize: "180%",
                roam: false,
                silent: true,
                itemStyle: {
                    normal: {
                        borderWidth: 1,
                        // borderColor: "rgba(57, 132, 188,0.4)",
                        borderColor: "rgba(58,149,253,0.6)",
                        shadowColor: "rgba(65, 214, 255,1)",
                        shadowOffsetY: 5,
                        shadowBlur: 15,
                        areaColor: "transpercent",
                    },
                },
            }, {
                type: "map",
                map: "bd",
                zlevel: -3,
                aspectScale: 1,
                zoom: 0.56,
                layoutCenter: ["50%", "53%"],
                layoutSize: "180%",
                roam: false,
                silent: true,
                itemStyle: {
                    normal: {
                        borderWidth: 1,
                        // borderColor: "rgba(11, 43, 97,0.8)",
                        borderColor: "rgba(58,149,253,0.4)",
                        shadowColor: "rgba(58,149,253,1)",
                        shadowOffsetY: 15,
                        shadowBlur: 10,
                        areaColor: "transpercent",
                    },
                },
            }, {
                type: "map",
                map: "bd",
                zlevel: -4,
                aspectScale: 1,
                zoom: 0.56,
                layoutCenter: ["50%", "54%"],
                layoutSize: "180%",
                roam: false,
                silent: true,
                itemStyle: {
                    normal: {
                        borderWidth: 5,
                        // borderColor: "rgba(11, 43, 97,0.8)",
                        borderColor: "rgba(5,9,57,0.8)",
                        shadowColor: "rgba(29, 111, 165,0.8)",
                        shadowOffsetY: 15,
                        shadowBlur: 10,
                        areaColor: "rgba(5,21,35,0.1)",
                    },
                },
            },
            ],
            series: [
                {
                    type: 'map',
                    zoom: 0.56,
                    roam: false,
                    map: 'bd',
                    aspectScale: 1,
                    layoutCenter: ["50%", "50%"],
                    layoutSize: "180%",
                    showLegendSymbol: true,
                    markPoint: {
                        symbol: "none",
                    },
                    label: {
                        normal: {
                            show: true,
                            textStyle: {
                                color: '#fff',
                            },
                        },
                        emphasis: {
                            textStyle: {
                                color: '#fff',
                            },
                        },
                    },
                    itemStyle: {
                        normal: {
                            areaColor: {
                                type: "linear",
                                x: 1200,
                                y: 0,
                                x2: 0,
                                y2: 0,
                                colorStops: [
                                    {
                                        offset: 0,
                                        color: "rgba(3,27,78,0.75)", // 0% 处的颜色
                                    },
                                    {
                                        offset: 1,
                                        color: "rgba(58,149,253,0.75)", // 50% 处的颜色
                                    },
                                ],
                                global: true, // 缺省为 false
                            },
                            borderColor: "#fff",
                            borderWidth: 0.2,
                        },
                        emphasis: {
                            show: false,
                            color: "#fff",
                            areaColor: "rgba(0,254,233,0.6)",
                        },
                    },
                    data: data,
                },
                {
                    tooltip: {
                        show: false,
                    },
                    type: 'effectScatter',
                    coordinateSystem: 'geo',
                    rippleEffect: {
                        scale: 10,
                        brushType: 'stroke',
                    },
                    showEffectOn: 'render',
                    itemStyle: {
                        normal: {
                            shadowColor: '#0ff',
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowOffsetY: 0,
                            color: function (params) {
                                var colorList = [
                                    new echarts.graphic.LinearGradient(1, 0, 0, 0, [
                                        {
                                            offset: 0,
                                            color: '#64fbc5',
                                        },
                                        {
                                            offset: 1,
                                            color: '#018ace',
                                        },
                                    ]),
                                    new echarts.graphic.LinearGradient(1, 0, 0, 0, [
                                        {
                                            offset: 0,
                                            color: '#64fbc5',
                                        },
                                        {
                                            offset: 1,
                                            color: '#018ace',
                                        },
                                    ]),
                                    new echarts.graphic.LinearGradient(1, 0, 0, 0, [
                                        {
                                            offset: 0,
                                            color: '#168e6d',
                                        },
                                        {
                                            offset: 1,
                                            color: '#c78d7b',
                                        },
                                    ]),
                                    new echarts.graphic.LinearGradient(1, 0, 0, 0, [
                                        {
                                            offset: 0,
                                            color: '#61c0f1',
                                        },
                                        {
                                            offset: 1,
                                            color: '#6f2eb6',
                                        },
                                    ]),
                                    new echarts.graphic.LinearGradient(1, 0, 0, 0, [
                                        {
                                            offset: 0,
                                            color: '#168e6d',
                                        },
                                        {
                                            offset: 1,
                                            color: '#c78d7b',
                                        },
                                    ]),
                                    new echarts.graphic.LinearGradient(1, 0, 0, 0, [
                                        {
                                            offset: 0,
                                            color: '#61c0f1',
                                        },
                                        {
                                            offset: 1,
                                            color: '#6f2eb6',
                                        },
                                    ]),
                                ];
                                return colorList[params.dataIndex];
                            },
                        },
                    },
                    label: {
                        normal: {
                            color: '#fff',
                        },
                    },
                    symbol: 'circle',
                    symbolSize: [10, 5],
                    data: mapDate,
                    zlevel: 1,
                },
                {
                    type: 'scatter',
                    coordinateSystem: 'geo',
                    itemStyle: {
                        color: '#f00',
                    },
                    symbol: function (value, params) {
                        return params.data.img;
                    },
                    symbolSize: [32, 41],
                    symbolOffset: [0, -20],
                    z: 9999,
                    data: mapDate,
                },
                {
                    type: 'scatter',
                    coordinateSystem: 'geo',

                    label: {
                        normal: {
                            show: true,
                            formatter: function (params) {
                                var name = params.name;
                                var value = params.data.datas;
                                //   var text = `{tline|${name}} : {fline|${value}}个`
                                // var text = `{tline|项目个数} : {fline|${value}}`

                                var text = `{tline|${name}}`;
                                return text;

                            },
                            color: '#fff',
                            rich: {
                                fline: {
                                    padding: [0, 25],
                                    color: '#fff',
                                    textShadowColor: '#030615',
                                    textShadowBlur: '0',
                                    textShadowOffsetX: 1,
                                    textShadowOffsetY: 1,
                                    fontSize: 8,
                                    fontWeight: 400,
                                },
                                tline: {
                                    padding: [6, 27],
                                    color: '#ABF8FF',
                                    fontSize: 12,
                                },
                            },
                        },
                        emphasis: {
                            show: true,
                        },
                    },
                    itemStyle: {
                        color: '#00FFF6',
                    },
                    symbol: img2,
                    symbolSize: [100, 50],
                    symbolOffset: [0, -60],
                    z: 999,
                    data: mapDate,
                },
            ],
        };
        myChart.setOption(option);
    });
};



//////////////
// var svg = "/profile/upload/2024/11/05/562c55e6-49b1-43c0-9fe7-f981ac897e5d.svg"
var svg = "//img.isqqw.com/profile/upload/2024/11/06/92419b05-0256-4787-bc8d-a0570648b274.json"
// img1 img2外层包的li是icon建议二选其一
let img1="//img.isqqw.com/profile/upload/2024/11/07/39bd7bcf-e5d1-4eee-824e-d0d9c9490104.png"
let img2="//img.isqqw.com/profile/upload/2024/11/07/40bb2078-58a1-4a4b-a0f4-67096334a760.png"

// echarts.registerMap('svg', { svg: svg });

const icon = "//img.isqqw.com/profile/upload/2024/11/04/a32fab3d-d51b-495e-b09c-d2d9c78e08d1.json"



const random = (lower, upper) => {
   lower = +lower || 0
   upper = +upper || 0
   return Math.random() * (upper - lower) + lower
}
const provinces = [
   {
      city: true,
      name: "太原",
      coord: [1383.6, 759.1],
      value: 456562,
   },
   {
      name: "古交市",
      coord: [1287.7, 755.4],
   },
   {
      name: "清徐县",
      coord: [1322.5, 855],
   },
   {
      name: "娄烦县",
      coord: [1165.4, 708.5],
   },
   // {
   //     name: '阳曲县',
   //     coord: [1496.5, 744.6]
   // },
   {
      name: "小店县",
      coord: [1388.5, 804.2],
   },
   {
      name: "万柏林区",
      coord: [1337.3, 783.6],
   },
   //=======
   {
      city: true,
      name: "忻州",
      coord: [1544, 638],
   },
   {
      name: "保德县",
      coord: [1120, 436],
   },
   {
      name: "河曲县",
      coord: [1236, 359],
   },
   // {
   //     name: '其岚县',
   //     coord: [1214, 483]
   // },
   // {
   //     name: '偏关县',
   //     coord: [1368, 342]
   // },
   // {
   //     name: '五寨县',
   //     coord: [1324, 483]
   // },
   {
      name: "静乐县",
      coord: [1317, 611],
   },
   // {
   //     name: '神池县',
   //     coord: [1460, 474]
   // },
   {
      name: "宁武县",
      coord: [1546.2, 501.7],
   },
   {
      name: "原平市",
      coord: [1638, 547],
   },
   // {
   //     name: '定襄县',
   //     coord: [1702, 639]
   // },
   // {
   //     name: '代县',
   //     coord: [1817, 507]
   // },
   {
      name: "五台县",
      coord: [1861, 624],
   },
   // {
   //     name: '繁峙县',
   //     coord: [1979, 513]
   // },
   //============
   {
      city: true,
      name: "朔州",
      coord: [1604, 391],
   },
   {
      name: "朔城区",
      coord: [1612.6, 430.6],
   },
   {
      name: "怀仁市",
      coord: [1898, 334],
   },
   {
      name: "应县",
      coord: [1920, 414],
   },
   {
      name: "山阴县",
      coord: [1732, 361],
   },
   {
      name: "右玉县",
      coord: [1711, 218],
   },
   {
      name: "平鲁区",
      coord: [1538.6, 332.6],
   },
   //=========
   {
      city: true,
      name: "大同",
      coord: [2102, 256],
      value: 285638,
   },
   // {
   //     name: '大同县',
   //     coord: [2166, 351]
   // },
   {
      name: "左云县",
      coord: [1826.7, 262.3],
   },
   // {
   //     name: '阳高县',
   //     coord: [2229.9, 248.6]
   // },
   {
      name: "浑源县",
      coord: [2140.5, 436.7],
   },
   // {
   //     name: '天镇县',
   //     coord: [2386.3, 244.1]
   // },
   // {
   //     name: '广灵县',
   //     coord: [2296.2, 428]
   // },
   // {
   //     name: '灵丘县',
   //     coord: [2237.8, 503.2]
   // },
   {
      name: "新荣区",
      coord: [2028.5, 215.6],
   },
   {
      name: "云冈区",
      coord: [2015.9, 281],
   },
   {
      name: "云州区",
      coord: [2195.8, 316.2],
   },
   //=========
   {
      city: true,
      name: "阳泉",
      coord: [1769.6, 861.7],
   },
   {
      name: "盂县",
      coord: [1759.3, 766.8],
   },
   {
      name: "平定县",
      coord: [1808, 881.4],
   },
   {
      name: "郊区",
      coord: [1760.2, 825.6],
   },
   {
      name: "矿区",
      coord: [1728, 844.8],
   },
   //=========
   {
      city: true,
      name: "吕梁",
      coord: [943, 804],
   },
   // {
   //     name: '汾阳市',
   //     coord: [1076.3, 874.2]
   // },
   {
      name: "孝义市",
      coord: [1013.2, 910.5],
   },
   {
      name: "临县",
      coord: [876.3, 625],
   },
   {
      name: "岚县",
      coord: [1115.2, 608.6],
   },
   {
      name: "兴县",
      coord: [990.9, 561.8],
   },
   {
      name: "方山县",
      coord: [997.1, 707.3],
   },
   {
      name: "中阳县",
      coord: [883, 862.8],
   },
   {
      name: "柳林县",
      coord: [791.7, 766.8],
   },
   {
      name: "文水县",
      coord: [1191, 864.9],
   },
   {
      name: "交城县",
      coord: [1171.1, 821],
   },
   {
      name: "交口县",
      coord: [818.5, 927.2],
   },
   // {
   //     name: '石楼县',
   //     coord: [697.2, 871.1]
   // },
   {
      name: "离石县",
      coord: [942.5, 876.7],
   },
   //=========
   {
      city: true,
      name: "晋中",
      coord: [1459, 905],
   },
   {
      name: "介休市",
      coord: [1063.3, 975.5],
   },
   // {
   //     name: '祁县',
   //     coord: [1247.6, 943.3]
   // },
   {
      name: "寿阳县",
      coord: [1620.6, 839.3],
   },
   {
      name: "昔阳县",
      coord: [1760.1, 966],
   },
   {
      name: "平遥县",
      coord: [1177.5, 954.1],
   },
   {
      name: "灵石县",
      coord: [967, 1010.2],
   },
   {
      name: "左权县",
      coord: [1598.3, 1051.3],
   },
   {
      name: "和顺县",
      coord: [1686.1, 1019],
   },
   // {
   //     name: '榆社县',
   //     coord: [1444.1, 1022.9]
   // },
   {
      name: "榆次区",
      coord: [1482.7, 922.4],
   },
   //=========
   {
      city: true,
      name: "临汾",
      coord: [808, 1162],
      value: 56254,
   },
   {
      name: "霍州市",
      coord: [946.3, 1095.4],
   },
   // {
   //     name: '侯马市',
   //     coord: [656, 1264.1]
   // },
   {
      name: "古县",
      coord: [988.5, 1161.9],
   },
   {
      name: "吉县",
      coord: [496.5, 1113],
   },
   {
      name: "隰县",
      coord: [725.3, 1025.3],
   },
   {
      name: "蒲县",
      coord: [666.3, 1136.4],
   },
   // {
   //     name: '曲沃县',
   //     coord: [706, 1272.8]
   // },
   {
      name: "翼城县",
      coord: [825.2, 1269.7],
   },
   // {
   //     name: '襄汾县',
   //     coord: [1111, 1111]
   // },
   {
      name: "洪洞县",
      coord: [871.2, 1137.9],
   },
   {
      name: "安泽县",
      coord: [1060.5, 1210.3],
   },
   // {
   //     name: '浮山县',
   //     coord: [899.7, 1219.1]
   // },
   {
      name: "乡宁县",
      coord: [537.8, 1165.9],
   },
   // {
   //     name: '大宁县',
   //     coord: [551.9, 1053]
   // },
   // {
   //     name: '永和县',
   //     coord: [599.3, 977.3]
   // },
   // {
   //     name: '汾西县',
   //     coord: [856.4, 1057.9]
   // },
   {
      name: "尧都县",
      coord: [815.1, 1202.5],
   },
   //=========
   {
      city: true,
      name: "长治",
      coord: [1336.6, 1222.4],
       value: 659812,
   },
   // {
   //     name: '沁县',
   //     coord: [1246.7, 1076.4]
   // },
   {
      name: "长子县",
      coord: [1251, 1256.2],
   },
   {
      name: "沁源县",
      coord: [1133.1, 1121.2],
   },
   // {
   //     name: '平顺县',
   //     coord: [1491.9, 1238.5]
   // },
   {
      name: "武乡县",
      coord: [1353, 1094.8],
   },
   {
      name: "襄垣县",
      coord: [1398.1, 1142.4],
   },
   // {
   //     name: '黎城县',
   //     coord: [1501.9, 1157.2]
   // },
   {
      name: "壶关县",
      coord: [1435.8, 1282.8],
   },
   {
      name: "屯留县",
      coord: [1258.3, 1155.4],
   },
   {
      name: "潞州区",
      coord: [1371.2, 1212.7],
   },
   {
      name: "潞城区",
      coord: [1405.4, 1197.7],
   },
   {
      name: "上党区",
      coord: [1303.9, 1310.6],
   },
   //=========
   {
      city: true,
      name: "运城",
      coord: [492, 1367],
      value: 15326,
      val: 999,
   },
   {
      name: "河津市",
      coord: [410.9, 1249.3],
      value: 4652,
   },
   {
      name: "永济市",
      coord: [216.2, 1401.4],
   },
   {
      name: "夏县",
      coord: [1111, 1111],
   },
   {
      name: "绛县",
      coord: [732.8, 1337.7],
   },
   {
      name: "新绛县",
      coord: [545.1, 1290.9],
   },
   {
      name: "临猗县",
      coord: [317, 1350.1],
   },
   {
      name: "万荣县",
      coord: [385.9, 1311.7],
   },
   {
      name: "闻喜县",
      coord: [613.2, 1351.3],
   },
   {
      name: "稷山县",
      coord: [482.1, 1270.3],
   },
   {
      name: "垣曲县",
      coord: [700.8, 1407],
   },
   {
      name: "平陆县",
      coord: [447.2, 1451.8],
   },
   {
      name: "芮城县",
      coord: [280.8, 1434.5],
   },
   //=========
   {
      city: true,
      name: "晋城",
      coord: [1137, 1376],
       value: 986524,
   },
   {
      name: "高平市",
      coord: [1186.7, 1326.3],
   },
   {
      name: "泽州县",
      coord: [1185.2, 1390.3],
   },
   {
      name: "沁水县",
      coord: [917.3, 1348.7],
   },
   {
      name: "阳城县",
      coord: [986.3, 1394.9],
   },
   {
      name: "陵川县",
      coord: [1346.6, 1407.8],
   },
];


const datas = {
   from: [1381.1, 766.7],
   to: provinces
      .filter((item) => item.city === true)
      .map((item, index) => {
         //  item.value = index % 2 === 0 ? 1 : 10;
         if (!item.value) {
            item.value = 0;
         }
         if (item.coord[0] < 1380) {
            item.lineStyle = {
               curveness: -0.3,
            };
         }
         return item;
      }),
   other: provinces.filter((item) => item.city === undefined),
};

console.log(datas)
$.get(icon, function (chinaJson) {
   $.get(svg, function (chinaSvg) {
 
let svgjson=chinaSvg.svg
      let icon = chinaJson
   
      echarts.registerMap('organ_diagram', { svg:svgjson });
      option = {
         backgroundColor: "#040b1c",
         title: {
            text: "地图系列的 SVG 底图-2",
            left: "center",
            bottom: 10,
         },
         tooltip: {
            show: true,
            trigger: "item",
            backgroundColor: "rgba(50,50,50,0.6)",
            borderColor: "#FFFFCC",
            textStyle: {
               color: "#ffffff",
            },
            transitionDuration: 0,
            showDelay: 0,
            hideDelay: 0,
            enterable: true,
            axisPointer: {
               // 坐标轴指示器，坐标轴触发有效
               type: "shadow", // 默认为直线，可选为：'line' | 'shadow'
            },
            confine: true,
            //     transitionDuration: 0,
            //     extraCssText: "z-index:100",
            formatter: function (params, ticket, callback) {
               console.log("实打实：", params);
               //根据业务自己拓展要显示的内容
               var res = "";
               var name = params.name;
               var value =
                  params.value[params.seriesIndex + 1] ||
                  params.value;
               res =
                  "<span style='color:#fff;'>" +
                  name +
                  "</span><br/>数据：" +
                  value;
               return res;
            },
         },
         visualMap: {
            //图例值控制
            min: 1,
            max: 10,
            calculable: true,
            show: false,
            color: ["#f44336", "#00eaff"],
            textStyle: {
               color: "#fff",
            },
         },
         geo: {
            left: 10,
            right: 10,
            map: "organ_diagram",
            itemStyle: {
               borderWidth: 0,
            },
            emphasis: {
               focus: "none",
               disabled: false,
               itemStyle: {
                  areaColor: "#00eaff",
                  color: "red",
                  borderColor: "#00eaff",
                  borderWidth: 3,
                  //     borderType:"dotted" ,//dashed  dotted solid
                  //     borderCap:"square",
                  opacity: 3,
               },
               label: {
                  show: false,
                  color: "#00eaff",
               },
            },

            regions: [
               {
                  name: "太原",
                  selected: true,
                  //     itemStyle: {
                  //         areaColor: "#f44336",
                  //         color: "#f44336",
                  //         opacity: 5,
                  //         borderWidth: 3, // 省份界线的宽度
                  //         borderColor: "#fff", // 省份界线颜色
                  //     },
                  select: {
                     itemStyle: {
                        areaColor: "#8fd3f4", // 高亮时候地图显示的颜色
                        borderWidth: 2, // 高亮时的边框宽度
                        opacity: 3,
                        borderColor: "#84fab0", // 省份界线颜色
                     },
                     label: {
                        fontSize: 12, // 选中地图文字字号和字体颜色
                        color: "#fff",
                     },
                  },
               },
            ],
            //     点击的tooltip
            tooltip: {
               show: true,
               formatter: (params) => {
                  // console.log("tooltip：",params)
                  let citylis = provinces.filter(
                     (item) => item.city === true
                  );
                  let datalist = citylis.filter(
                     (item) => item.name === params.name
                  );
                  //     return `<div>${params.name}&emsp;  </br>${
                  //         datalist[0].value || 0
                  //     }</div>`;
                  let html = "";
                  html += `<div style="color: #fff;font-size: 16px;height: 105px;padding: 16px;
                      background: linear-gradient(180deg, rgba(37,108,233,0.44) 0%, rgba(23,80,169,0.1) 22%, rgba(20,64,137,0) 46%, rgba(16,51,111,0.28) 77%, rgba(30,101,213,0.4) 100%);
                      border-radius: 2px;border: 1px solid;border-image: radial-gradient(circle, rgba(111, 185, 242, 0.86), rgba(0, 0, 0, 0.2)) 1 1;
                      backdrop-filter: blur(10px);">
                        <div>
                          <div style="margin-bottom: 16px"><i style="color:#00eaff" class="el-icon-s-opportunity"><image style="width:17px;height:17px" src="${img1}"></image></i>${
                     params.name
                     }</div>
                          <div style="margin-bottom: 12px">
                            <span style="display:inline-block;margin-right:4px;border:1px solid #fff;border-radius:10px;width:10px;height:10px;background-color:#0CC8E6;"></span>
                            <span style="font-size: 14px;">${params.name}</span>
                            <span style="margin-left: 16px;color: #0CC8E6;">${
                     datalist[0].value || 0
                     }</span>
                          </div>
                       
                        </div>
                      </div>`;
                  return html;

               },
            },
         },
         series: [

            {
               type: "effectScatter",
               coordinateSystem: "geo",
               zlevel: 2,
               rippleEffect: {
                  //涟漪特效
                  period: 7, //动画时间，值越小速度越快
                  brushType: "stroke", //波纹绘制方式 stroke, fill
                  scale: 5, //波纹圆环最大限制，值越大波纹越大
               },
               label: {
                  show: false,
                  position: "right", //显示位置
                  offset: [5, 0], //偏移设置
                  formatter: function (params) {
                     //圆环显示文字
                     return params.data.name;
                  },
                  fontSize: 13,
               },
               emphasis: {
                  show: true,
               },
               // symbol: "circle",
               symbol: icon.iconGD, //图标 iconGD  iconLD iconRQ iconJG iconLJZ  iconJD1 iconJD2 iconSS
               symbolSize: function (val) {
                  return 7; //圆环大小
               },
               itemStyle: {
                  show: false,
                  color: "#f00",
               },
               data: datas.to.map(function (item) {
                  return {
                     name: item.name,
                     value: [...item.coord, item.value],
                  };
               }),
               tooltip: {
                  formatter: (params) => {
                     // return params.name + "88888";
                     // return `<div>${params.name}&emsp;  </br>${
                     //     params.value[2] || 0
                     // }</div>`;
                     let html = "";
                     html += `<div style="color: #fff;font-size: 16px;height: 105px;padding: 16px;
                      background: linear-gradient(180deg, rgba(37,108,233,0.44) 0%, rgba(23,80,169,0.1) 22%, rgba(20,64,137,0) 46%, rgba(16,51,111,0.28) 77%, rgba(30,101,213,0.4) 100%);
                      border-radius: 2px;border: 1px solid;border-image: radial-gradient(circle, rgba(111, 185, 242, 0.86), rgba(0, 0, 0, 0.2)) 1 1;
                      backdrop-filter: blur(10px);">
                        <div>
                          <div style="margin-bottom: 16px"><i style="color:#00eaff" class="el-icon-location"><image style="width:17px;height:17px" src="${img2}"></image></i>${
                        params.name
                        }</div>
                          <div style="margin-bottom: 12px">
                            <span style="display:inline-block;margin-right:4px;border:1px solid #fff;border-radius:10px;width:10px;height:10px;background-color:#0CC8E6;"></span>
                            <span style="font-size: 14px;">${params.name}</span>
                            <span style="margin-left: 16px;color: #0CC8E6;">${
                        params.value[2] || 0
                        }</span>
                          </div>
                       
                        </div>
                      </div>`;
                     return html;
                  },
               },
            },

         ],
      };


      let nameList = provinces
         .filter((item) => item.city === true)
         .map((i) => {
            return { name: i.name, isshow: false };
         });
      myChart.setOption(option);


      myChart.on('click', function (event) {
         console.log(event);
         if (event.componentIndex == 0) {
            nameList.forEach((it) => {
               if (it.name == event.name) {
                  it.isshow = true;
                  myChart.dispatchAction({
                     type: "highlight",
                     geoIndex: 0,
                     name: event.name,
                  });
               } else {
                  it.isshow = false;
                  myChart.dispatchAction({
                     type: "downplay",
                     geoIndex: 0,
                     name: it.name,
                  });
               }
            });
            //     console.log("名称：", nameList);
         }
      });
      autoFn(nameList, myChart);
      function autoFn(nameList, myChart) {
         var that = this;
         //轮播效果
         var currentIndex = -1;

         //  let myChart = echarts.getInstanceByDom(document.getElementById("chart-panel"))
         var dataLen = nameList.length;

         that.timer = setInterval(() => {
            //  计时器增加
            that.ai++;

            if (that.ai == dataLen) {
               that.ai = 1;
            }
            // console.log(nameList);

            // // 取消之前高亮的图形
            // myChart.dispatchAction({
            //     type: "downplay",
            //     seriesIndex: 0,
            //     dataIndex: currentIndex,
            // });
            currentIndex = (currentIndex + 1) % dataLen;

            myChart.dispatchAction({
               type: "highlight",
               geoIndex: 0,
               name: nameList[currentIndex].name,
            });

            // console.log("的撒旦111：", nameList[currentIndex]);
            // console.log(
            //     "大撒大撒：",
            //     currentIndex,
            //     nameList[currentIndex].name
            // );
            setTimeout(() => {
               if (currentIndex - 1 == -1) {
                  myChart.dispatchAction({
                     type: "downplay",
                     geoIndex: 0,
                     name: "太原",
                  });
               } else {
                  myChart.dispatchAction({
                     type: "downplay",
                     geoIndex: 0,
                     name: nameList[currentIndex].name,
                  });
               }
            }, 4800);

            // // 高亮当前图形
            // myChart.dispatchAction({
            //     type: "highlight",
            //     seriesIndex: 0,
            //     dataIndex: currentIndex,
            // });
            // 显示 tooltip
            myChart.dispatchAction({
               type: "showTip",
               seriesIndex: 0,
               dataIndex: currentIndex,
            });
         }, 5000);
      }





   })
})





